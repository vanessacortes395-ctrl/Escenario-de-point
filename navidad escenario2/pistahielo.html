<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <title>PISTA DE HIELO</title>
</head>
<body>
    
<canvas id="myCanvas">
    <!--El elemento HTML canvas se puede utilizar para dibujar grÃ¡ficos a travÃ©s de 
        secuencias de comandos (por lo general JavaScript ).-->
</canvas>

<!-- AquÃ­ va todo el cÃ³digo de three.js -->
<!-- script type="importmap" importa las librerÃ­as necesarias para three.js-->
<script type="importmap"> 
    {
        "imports":{
            "three": "./js/three.module.js",
            "three/OrbitControls": "./js/OrbitControls.js" 
        }
}
</script>
<script type="module"> 
//ðŸ—ƒï¸ðŸ—ƒï¸ Mandar llamar a la librerÃ­a
    import * as THREE from 'three'; 
    import {OrbitControls} from 'three/OrbitControls';
    console.log(OrbitControls);
    import {RoundedBoxGeometry} from "./js/RoundedBoxGeometry.js"

//ðŸ•¹ï¸ðŸ•¹ï¸ Renderer - Realiza una conexiÃ³n entre el cÃ³digo y el canvas
    var renderer = new THREE.WebGLRenderer({
    canvas: document.getElementById('myCanvas'), antialias: true,
    });
    renderer.setPixelRatio(window.decivePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0xEBEBEB);


// ðŸŽ¬ Creando nueva escena - Es el espacio donde se colocan los objetos
    var scene = new THREE.Scene();

//ðŸŽ¥ðŸŽ¥ Agregar una cÃ¡mara de perspectiva
    var camera = new THREE.PerspectiveCamera(70,window.innerWidth / window.innerHeight,0.1,2000
      );
    scene.add(camera);
    const sizes ={
        width: window.innerWidth,
        height: window.innerHeight,
    };
    //redimensionar canvas
      const canvas = document.getElementById('myCanvas');
      window.addEventListener('resize', () => {
      })
sizes.width = window.innerWidth;
sizes.height = window.innerHeight;

 camera.aspect = sizes.width / sizes.height;
 camera.updateProjectionMatrix();
 renderer.setSize(sizes.width, sizes.height);

    //Settings de la cÃ¡mara
    camera.position.set(0, 4, 30);

    // AÃ±adiendo los OrbitControls
    var controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;

    var gridHelper = new THREE.GridHelper(50,50,);
    //scene.add (gridHelper);

    var gridHelper = new THREE.PolarGridHelper(20,16,20,64);
    //scene. add (gridHelper); //maya

    var gridHelper = new THREE.AxesHelper(500);
    //scene. add (gridHelper);  //lineas de coodenadas

    ///////////
    ///LUCES
   var light1= new THREE.DirectionalLight(0Xffffff,0.8);
   light1.position.set (0,20,50);
   scene.add(light1);

//        PISTA DE HIELO CON GENTE

function PistaDeHielo({ x, y, z }) {

    const PistaGroup = new THREE.Group();

    // --- MATERIALS ---
    const mHielo = new THREE.MeshLambertMaterial({ color: 0xDEFFFD }); // azul claro hielo
    const mBarda = new THREE.MeshLambertMaterial({ color: 0x8b5a32 }); // madera / barda
    const mGenteRopa1 = new THREE.MeshLambertMaterial({ color: 0xff3366 });
    const mGenteRopa2 = new THREE.MeshLambertMaterial({ color: 0x3366ff });
    const mGentePiel = new THREE.MeshLambertMaterial({ color: 0xffe0c8 });
    const mNegro = new THREE.MeshLambertMaterial({ color: 0x000000 });

    // --- SUPERFICIE DE HIELO  ---
    const gHielo = new THREE.BoxGeometry(20, 0.2, 12);
    const meshHielo = new THREE.Mesh(gHielo, mHielo);
    meshHielo.position.set(0, 0.1, 0);
    PistaGroup.add(meshHielo);

    //  BARDAS 
    const gBardaL = new THREE.BoxGeometry(20.4, 0.8, 0.4);
    const bardaNorte = new THREE.Mesh(gBardaL, mBarda);
    bardaNorte.position.set(0, 0.6, -6.2);
    PistaGroup.add(bardaNorte);

    const bardaSur = new THREE.Mesh(gBardaL, mBarda);
    bardaSur.position.set(0, 0.6, 6.2);
    PistaGroup.add(bardaSur);

    const gBardaV = new THREE.BoxGeometry(0.4, 0.8, 12.4);
    const bardaOeste = new THREE.Mesh(gBardaV, mBarda);
    bardaOeste.position.set(-10.2, 0.6, 0);
    PistaGroup.add(bardaOeste);

    const bardaEste = new THREE.Mesh(gBardaV, mBarda);
    bardaEste.position.set(10.2, 0.6, 0);
    PistaGroup.add(bardaEste);

    //  PIEZAS DECORATIVAS EN LAS ESQUINAS 
    const gPoste = new THREE.CylinderGeometry(0.18, 0.18, 1.2, 12);
    const poste1 = new THREE.Mesh(gPoste, mBarda);
    poste1.position.set(-10.2, 1.0, -6.2);
    PistaGroup.add(poste1);

    const poste2 = new THREE.Mesh(gPoste, mBarda);
    poste2.position.set(10.2, 1.0, -6.2);
    PistaGroup.add(poste2);

    const poste3 = new THREE.Mesh(gPoste, mBarda);
    poste3.position.set(-10.2, 1.0, 6.2);
    PistaGroup.add(poste3);

    const poste4 = new THREE.Mesh(gPoste, mBarda);
    poste4.position.set(10.2, 1.0, 6.2);
    PistaGroup.add(poste4);

    //  PERSONAS 
    // Persona 1
    const cabeza1 = new THREE.Mesh(new THREE.SphereGeometry(0.22, 8, 8), mGentePiel);
    cabeza1.position.set(-6.5, 0.9, -1.5);
    PistaGroup.add(cabeza1);
    const cuerpo1 = new THREE.Mesh(new THREE.CylinderGeometry(0.28, 0.4, 0.9, 12), mGenteRopa1);
    cuerpo1.position.set(-6.5, 0.35, -1.5);
    PistaGroup.add(cuerpo1);
    const pier1_1 = new THREE.Mesh(new THREE.BoxGeometry(0.15, 0.05, 0.6), mNegro);
    pier1_1.position.set(-6.5, 0.05, -1.0);
    PistaGroup.add(pier1_1);
    const pier1_2 = new THREE.Mesh(new THREE.BoxGeometry(0.15, 0.05, 0.6), mNegro);
    pier1_2.position.set(-6.5, 0.05, -2.0);
    PistaGroup.add(pier1_2);

    // Persona 2
    const cabeza2 = new THREE.Mesh(new THREE.SphereGeometry(0.22, 8, 8), mGentePiel);
    cabeza2.position.set(-3.5, 0.9, 1.0);
    PistaGroup.add(cabeza2);
    const cuerpo2 = new THREE.Mesh(new THREE.CylinderGeometry(0.28, 0.4, 0.9, 12), mGenteRopa2);
    cuerpo2.position.set(-3.5, 0.35, 1.0);
    PistaGroup.add(cuerpo2);
    const pier2_1 = new THREE.Mesh(new THREE.BoxGeometry(0.15, 0.05, 0.6), mNegro);
    pier2_1.position.set(-3.5, 0.05, 1.4);
    PistaGroup.add(pier2_1);
    const pier2_2 = new THREE.Mesh(new THREE.BoxGeometry(0.15, 0.05, 0.6), mNegro);
    pier2_2.position.set(-3.5, 0.05, 0.6);
    PistaGroup.add(pier2_2);

    // Persona 3 (niÃ±o)
    const cabeza3 = new THREE.Mesh(new THREE.SphereGeometry(0.18, 8, 8), mGentePiel);
    cabeza3.position.set(0.5, 0.75, -2.5);
    PistaGroup.add(cabeza3);
    const cuerpo3 = new THREE.Mesh(new THREE.CylinderGeometry(0.22, 0.28, 0.7, 12), mGenteRopa1);
    cuerpo3.position.set(0.5, 0.15, -2.5);
    PistaGroup.add(cuerpo3);
    const pier3_1 = new THREE.Mesh(new THREE.BoxGeometry(0.12, 0.04, 0.5), mNegro);
    pier3_1.position.set(0.5, -0.1, -2.2);
    PistaGroup.add(pier3_1);
    const pier3_2 = new THREE.Mesh(new THREE.BoxGeometry(0.12, 0.04, 0.5), mNegro);
    pier3_2.position.set(0.5, -0.1, -2.8);
    PistaGroup.add(pier3_2);

    // Persona 4 (pareja)
    const cabeza4a = new THREE.Mesh(new THREE.SphereGeometry(0.2, 8, 8), mGentePiel);
    cabeza4a.position.set(2.2, 0.9, -0.5);
    PistaGroup.add(cabeza4a);
    const cuerpo4a = new THREE.Mesh(new THREE.CylinderGeometry(0.26, 0.36, 0.85, 12), mGenteRopa2);
    cuerpo4a.position.set(2.2, 0.35, -0.5);
    PistaGroup.add(cuerpo4a);
    const cabeza4b = new THREE.Mesh(new THREE.SphereGeometry(0.2, 8, 8), mGentePiel);
    cabeza4b.position.set(3.0, 0.9, -0.6);
    PistaGroup.add(cabeza4b);
    const cuerpo4b = new THREE.Mesh(new THREE.CylinderGeometry(0.26, 0.36, 0.85, 12), mGenteRopa1);
    cuerpo4b.position.set(3.0, 0.35, -0.6);
    PistaGroup.add(cuerpo4b);
    const pier4a = new THREE.Mesh(new THREE.BoxGeometry(0.12, 0.04, 0.5), mNegro);
    pier4a.position.set(2.2, -0.1, -0.1);
    PistaGroup.add(pier4a);
    const pier4b = new THREE.Mesh(new THREE.BoxGeometry(0.12, 0.04, 0.5), mNegro);
    pier4b.position.set(3.0, -0.1, -0.2);
    PistaGroup.add(pier4b);

    // Persona 5
    const cabeza5 = new THREE.Mesh(new THREE.SphereGeometry(0.22, 8, 8), mGentePiel);
    cabeza5.position.set(5.0, 0.9, 0.8);
    PistaGroup.add(cabeza5);
    const cuerpo5 = new THREE.Mesh(new THREE.CylinderGeometry(0.28, 0.4, 0.9, 12), mGenteRopa1);
    cuerpo5.position.set(5.0, 0.35, 0.8);
    PistaGroup.add(cuerpo5);
    const pier5_1 = new THREE.Mesh(new THREE.BoxGeometry(0.15, 0.05, 0.6), mNegro);
    pier5_1.position.set(5.0, 0.05, 1.2);
    PistaGroup.add(pier5_1);
    const pier5_2 = new THREE.Mesh(new THREE.BoxGeometry(0.15, 0.05, 0.6), mNegro);
    pier5_2.position.set(5.0, 0.05, 0.4);
    PistaGroup.add(pier5_2);

    // --- BANCO (fuera de pista, para espectadores) ---
    const gBanco = new THREE.BoxGeometry(6, 0.3, 0.8);
    const mBanco = new THREE.MeshLambertMaterial({ color: 0x8b5a32 });
    const banco = new THREE.Mesh(gBanco, mBanco);
    banco.position.set(0, 0.4, -8.5);
    PistaGroup.add(banco);

    // --- POSICIÃ“N GLOBAL ---
    PistaGroup.position.set(x, y, z);
    return PistaGroup;
}

// --- AGREGAR A LA ESCENA ---
const miPista = PistaDeHielo({ x: 0, y: 0, z: -10 });
scene.add(miPista);

    


//ðŸŽ°ðŸŽ°Rendering y animaciÃ³n
    requestAnimationFrame(render);
    function render() {

    //ðŸª„ðŸª„ AnimaciÃ³n - 
 
    //ðŸŽ®ðŸŽ®ActualizaciÃ³n del OrbitControls para generar la suavidad de movimiento
    controls.update();

    //Llamado para renderizar y volver a llamar a la misma funciÃ³n (render)
    renderer.render(scene, camera);
    requestAnimationFrame(render);
    }
</script>
</body>
</html>